LOAD DATA LOCAL INFILE "C:/ProgramData/MySQL/MySQL Server 8.0/Uploads/baseball_repository/lookup_linear_weights_1901_2023.csv"
INTO TABLE lookup_linear_weights
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS;

LOAD DATA LOCAL INFILE "C:/ProgramData/MySQL/MySQL Server 8.0/Uploads/baseball_repository/lookup_age_date_1901_2023.csv"
INTO TABLE baseball_repository.lookup_age_date
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n' 
IGNORE 1 ROWS;

INSERT INTO lookup_run_environment (
season_id,
team_count,
team_runs_avg
)
SELECT a.season_id,
COUNT(DISTINCT(a.team_id)),
(b.runs_for + c.runs_against)/(COUNT(DISTINCT(a.team_id))) 
FROM standard_standings AS a
INNER JOIN (SELECT season_id, SUM(b_r) AS runs_for FROM standard_batting GROUP BY season_id) AS b
ON a.season_id = b.season_id
INNER JOIN (SELECT season_id, SUM(p_r) AS runs_against FROM standard_pitching GROUP BY season_id) AS c
ON a.season_id = c.season_id
GROUP BY a.season_id
ORDER BY a.season_id DESC;
